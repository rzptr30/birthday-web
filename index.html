<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday, Adellia! ğŸ«¶ğŸ»ğŸ‚âœ¨</title>
  <meta name="description" content="Situs mini untuk merayakan ulang tahun kamu. Dibuat penuh cinta ğŸ’–" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="src/css/styles.css" />
</head>
<body>
  <!-- Kanvas efek -->
  <canvas id="hearts" aria-hidden="true"></canvas>
  <canvas id="confetti" aria-hidden="true"></canvas>

  <!-- HERO -->
  <header>
    <div class="halo" aria-hidden="true"></div>
    <div class="hero" role="banner">
      <div class="badge">
        ğŸ‰ Ulang Tahun Ke- <span id="age">?</span> â€¢ <span id="dateLbl">â€”</span>
      </div>
      <h1>Happy Birthday, <span class="love" id="name">Sayang</span>! ğŸ’–</h1>
      <p class="sub">
        Terima kasih sudah hadir dan mewarnai hariku. Ini hadiah kecil: satu halaman yang hanya untuk kamu. âœ¨
      </p>

      <div class="timers split">
        <div class="timer-col">
          <p class="muted small title-col">Sudah hidup selama</p>
            <div class="countdown" id="lifeTimer" aria-label="Total hidup dalam hari jam menit dan detik"></div>
          <p class="muted small" style="margin-top:8px">atau</p>
            <div class="countdown" id="ageYMD" aria-label="Usia dalam tahun bulan hari"></div>
        </div>
        <div class="timer-col">
          <p class="muted small title-col">Sejak kita resmi berpacaran</p>
            <div class="countdown" id="datingTimer" aria-label="Hari sejak jadian"></div>
          <p class="muted small title-col" style="margin-top:18px">Sejak pertama kali kita saling mengenal</p>
            <div class="countdown" id="metTimer" aria-label="Hari sejak pertama kenal"></div>
        </div>
      </div>

      <div class="cta">
        <button class="btn primary" id="btnPlay">â–¶ï¸ Putar Musik</button>
        <button class="btn primary" onclick="document.getElementById('gallery').scrollIntoView({behavior:'smooth'})">
          Lihat Kenangan ğŸ“·
        </button>
        <button class="btn primary" id="btnBooth">Ke Photo Booth ğŸ“¸</button>
      </div>
    </div>
  </header>

  <main>
    <!-- SURAT KECIL -->
    <section class="section" id="about">
      <div class="card grid cols-2">
        <div>
          <h2>Surat Kecil Untukmu</h2>
          <p id="loveNote">Terima kasih sudah selalu sabar dan bikin aku merasa cukup.</p>
          <p class="muted">
            Di bawah ada galeri cerita, tempat untuk abadikan momen, dan ucapan spesial. Semoga halaman ini hangat seperti pelukan. ğŸ˜Š
          </p>
        </div>
        <div>
          <h2>Detail Hari-H</h2>
          <p>
            <b>Tanggal:</b> <span id="dateText">â€”</span><br />
            <b>Lokasi:</b> Cafe favorit / Rumah<br />
            <b>Dress code:</b> Casual pastel
          </p>
        </div>
      </div>
    </section>

    <!-- GALERI KENANGAN -->
    <section class="section" id="gallery">
      <div class="card">
        <h2>Galeri Kenangan</h2>
        <p>Setiap foto punya cerita kecil di bawahnya. Taruh gambar di <code>assets/gallery</code>.</p>
        <div class="gallery-stories" id="galStories" aria-live="polite"></div>
      </div>
    </section>

    <!-- PHOTO BOOTH 3 SLOT -->
    <section class="section" id="frame">
      <div class="card">
        <h2>Abadikan Momen Ini ğŸ“¸</h2>

        <div id="choiceRow" class="choices">
          <button class="btn primary" id="btnCamFlow">Ambil Foto (Kamera)</button>
          <button class="btn primary" id="btnUploadFlow">Upload 3 Foto</button>
        </div>

        <!-- FLOW KAMERA -->
        <div id="boothWrap" class="booth hidden" aria-hidden="true">
          <div class="booth-left">
            <div class="video-wrap" id="videoWrap">
              <video id="cam" playsinline autoplay muted></video>
              <div id="countOverlay"></div>
            </div>
            <div class="booth-ctrl">
              <button class="btn primary" id="btnStartCam">Nyalakan Kamera</button>
              <select class="btn" id="captureDelay" disabled aria-label="Timer penangkap foto">
                <option value="3">Timer 3s</option>
                <option value="5">Timer 5s</option>
                <option value="10">Timer 10s</option>
              </select>
              <button class="btn" id="btnFlip" disabled>Balik ğŸ”„</button>
              <button class="btn" id="btnMirror" disabled>Mirror â†”ï¸</button>
              <button class="btn" id="btnAutoShot" disabled>Ambil 3 Foto â–¶ï¸</button>
              <button class="btn" id="btnReset" disabled>Reset</button>
              <button class="btn" id="btnConfirmCam" disabled>Lanjutkan</button>
            </div>
          </div>
          <div class="booth-right">
            <div id="slotGrid" class="thumbs" aria-label="Hasil foto sementara">
              <canvas class="slot" data-i="0" width="240" height="320" aria-label="Slot 1"></canvas>
              <canvas class="slot" data-i="1" width="240" height="320" aria-label="Slot 2"></canvas>
              <canvas class="slot" data-i="2" width="240" height="320" aria-label="Slot 3"></canvas>
            </div>
            <p class="muted">Klik foto untuk retake (muncul konfirmasi & countdown).</p>
          </div>
        </div>

        <!-- FLOW UPLOAD -->
        <div id="uploadWrap" class="booth hidden" aria-hidden="true">
          <div class="booth-left">
            <input type="file" id="files3" accept="image/*" multiple aria-label="Pilih hingga 3 foto" />
            <div class="booth-ctrl">
              <button class="btn" id="btnClearUpload">Bersihkan Pilihan</button>
              <button class="btn" id="btnConfirmUpload" disabled>Lanjutkan</button>
            </div>
          </div>
          <div class="booth-right">
            <div id="uploadGrid" class="thumbs" aria-label="Slot foto upload">
              <canvas class="upslot" data-i="0" width="240" height="320" aria-label="Upload slot 1"></canvas>
              <canvas class="upslot" data-i="1" width="240" height="320" aria-label="Upload slot 2"></canvas>
              <canvas class="upslot" data-i="2" width="240" height="320" aria-label="Upload slot 3"></canvas>
            </div>
            <p class="muted">Pilih tepat 3 foto. Klik untuk mengganti.</p>
          </div>
        </div>

        <!-- DIALOG KONFIRMASI -->
        <dialog id="confirmDlg">
          <p id="confirmMsg">Konfirmasi?</p>
          <form method="dialog" class="confirm-actions">
            <button class="btn">Batal</button>
            <button class="btn primary" value="ok">Ya</button>
          </form>
        </dialog>

        <!-- DIALOG RETAKE -->
        <dialog id="retakeDlg">
          <p id="retakeMsg">Retake foto ini?</p>
          <form method="dialog" class="confirm-actions">
            <button class="btn">Batal</button>
            <button class="btn primary" value="do">Retake</button>
          </form>
        </dialog>

        <!-- HASIL FINAL -->
        <div id="resultWrap" class="result hidden">
          <div class="preview" id="framePreview">
            <canvas id="frameCanvas" width="1200" height="2133" aria-label="Hasil komposit 3 foto"></canvas>
          </div>
          <div class="booth-ctrl">
            <a class="btn primary" id="btnDownload" download="moment-3frame.png" href="#" style="opacity:.6;pointer-events:none">Download</a>
            <button class="btn" id="btnBackChoose">Kembali</button>
          </div>
          <p class="muted">Template overlay: <code>assets/overlays/Template-Foto.png</code>.</p>
        </div>
      </div>
    </section>

    <!-- UCAPAN KHUSUS -->
    <section class="section" id="letter">
      <div class="card">
        <h2>Selamat Ulang Tahun, Sayang ğŸ’–</h2>
        <p class="muted">Ada ucapan spesial yang bisa kamu buka. Kalau suka, kamu boleh simpan sendiri.</p>
        <button class="btn primary" id="btnOpenWish">Buka Ucapan ğŸ</button>
      </div>
    </section>
  </main>

  <footer>Dibuat dengan â¤ï¸</footer>

  <!-- Popup Ucapan -->
  <dialog id="wishDlg" class="paper">
    <div class="paper-inner">
      <h3>Ucapan Untukmu âœ¨</h3>
      <p id="wishText"></p>
      <div class="paper-actions single">
        <button class="btn" id="btnCloseWish">Tutup</button>
      </div>
    </div>
  </dialog>

  <!-- Audio -->
  <audio id="bgm" preload="auto" loop src="assets/audio/penjaga-hati.mp3"></audio>
  <audio id="shutterSound" preload="auto" src="assets/audio/shutter.mp3"></audio>

  <!-- Gate akses tanggal spesial -->
  <div id="gate" style="position:fixed;inset:0;background:#0b1022;display:none;align-items:center;justify-content:center;z-index:9999">
    <div class="card" style="max-width:420px;margin:16px;text-align:center">
      <h2>Hi, ini khusus buat kamu ğŸ’</h2>
      <p class="muted">Masukkan <b>tanggal spesial</b> kita (<i>angka saja</i>).</p>
      <input id="gateInput" inputmode="numeric" pattern="[0-9]*"
             aria-label="Tanggal spesial (format ddmmyy)"
             style="width:100%;background:#0b1220;border:1px solid #334155;border-radius:12px;padding:12px;color:#e5e7eb;margin-top:10px" />
      <button class="btn primary" id="gateBtn" style="margin-top:12px">Masuk</button>
      <p class="sub" style="margin-top:10px">Hint: format <b>ddmmyy</b> (29â€†08â€†24)</p>
    </div>
  </div>

  <!-- JS -->
  <script defer src="src/js/main.js"></script>
</body>
</html>